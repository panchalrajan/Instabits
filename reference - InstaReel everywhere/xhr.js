const originalXHR=window.XMLHttpRequest;let repeatURL="",repeatBody="",repeatHeaders={};function shouldRepeat(e){try{let t=JSON.parse(e);if(t?.data.xdt_api__v1__clips__home__connection_v2)return!0}catch(e){}return!1}function repeatHandler(e){if(e.data&&"REPEAT_XHR_CALL"===e.data.type){const e=new XMLHttpRequest;e.open("POST",repeatURL,!0);for(const t in repeatHeaders)repeatHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,repeatHeaders[t]);e.send(repeatBody)}}window.XMLHttpRequest=function(){const e=new originalXHR,t=e.send;e._headers={};const s=e.setRequestHeader;return e.setRequestHeader=function(t,r){return e._headers[t]=r,s.apply(e,arguments)},e.send=function(s){return this.addEventListener("readystatechange",(()=>{4===this.readyState&&this.responseURL.includes("graphql/query")&&(window.postMessage({type:"XHR_INTERCEPTED",data:{requestBody:s,url:this.responseURL,status:this.status,response:this.response}},"*"),shouldRepeat(this.response)&&(repeatURL=this.responseURL,repeatBody=s,repeatHeaders=e._headers))})),t.apply(this,arguments)},e},window.addEventListener("message",repeatHandler);